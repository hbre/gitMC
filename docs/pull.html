<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.5.3" />
<title>gitutils.pull API documentation</title>
<meta name="description" content="" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.name small{font-weight:normal}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase;cursor:pointer}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title"><code>gitutils.pull</code> module</h1>
</header>
<section id="section-intro">
<details class="source">
<summary>Source code</summary>
<pre><code class="python">from operator import attrgetter
from pathlib import Path
from typing import List
import subprocess
import logging
from time import sleep
from sys import stderr

from .git import baddir, GITEXE


def fetchpull(mode: str, rdir: Path) -&gt; List[str]:
    &#34;&#34;&#34;
    handles recursive &#34;git pull&#34; and &#34;git fetch&#34;

    Parameters
    ----------

    mode : str
        fetch or pull
    rdir : pathlib.Path
        top-level path over Git repos

    Results
    -------

    failed : list of str
        names of Git repos with failures


    Reference:
    ----------
    format mini-language:
    https://docs.python.org/3/library/string.html#format-specification-mini-language
    &#34;&#34;&#34;
    # leave .resolve() for useful error messages
    rdir = Path(rdir).expanduser().resolve()

    dlist = [x for x in rdir.iterdir() if not baddir(x)]

    if not dlist:
        if not baddir(rdir):
            dlist = [rdir]
        else:
            raise FileNotFoundError(f&#39;no Git repos found under {rdir}&#39;)

    Lmax = len(max(map(attrgetter(&#39;name&#39;), dlist), key=len))
    print(&#39;git&#39;, mode, len(dlist), &#39;paths under&#39;, rdir)

    failed = []
    assert isinstance(GITEXE, str)

    for d in dlist:

        print(f&#39; --&gt; {d.name:&lt;{Lmax}}&#39;, end=&#34;&#34;, flush=True)
        try:
            # don&#39;t use timeout as it doesn&#39;t work right when waiting for user input (password)
            subprocess.check_output([GITEXE] + mode.split(), cwd=d,
                                    universal_newlines=True)
            print(end=&#34;\r&#34;)
        except subprocess.CalledProcessError:
            failed.append(d.name)

        sleep(.1)  # don&#39;t hammer the remote server

    print()
    if failed:
        logging.error(f&#39;git {mode} {rdir}&#39;)
        # no backslash allowed in f-strings
        print(&#39;\n&#39;.join(failed), file=stderr)

    return failed</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="gitutils.pull.fetchpull"><code class="name flex">
<span>def <span class="ident">fetchpull</span></span>(<span>mode, rdir)</span>
</code></dt>
<dd>
<section class="desc"><p>handles recursive "git pull" and "git fetch"</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>mode</code></strong> :&ensp;<code>str</code></dt>
<dd>fetch or pull</dd>
<dt><strong><code>rdir</code></strong> :&ensp;<code>pathlib.Path</code></dt>
<dd>top-level path over Git repos</dd>
</dl>
<h2 id="results">Results</h2>
<dl>
<dt><strong><code>failed</code></strong> :&ensp;<code>list</code> of <code>str</code></dt>
<dd>names of Git repos with failures</dd>
</dl>
<h2 id="reference">Reference:</h2>
<p>format mini-language:
<a href="https://docs.python.org/3/library/string.html#format-specification-mini-language">https://docs.python.org/3/library/string.html#format-specification-mini-language</a></p></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def fetchpull(mode: str, rdir: Path) -&gt; List[str]:
    &#34;&#34;&#34;
    handles recursive &#34;git pull&#34; and &#34;git fetch&#34;

    Parameters
    ----------

    mode : str
        fetch or pull
    rdir : pathlib.Path
        top-level path over Git repos

    Results
    -------

    failed : list of str
        names of Git repos with failures


    Reference:
    ----------
    format mini-language:
    https://docs.python.org/3/library/string.html#format-specification-mini-language
    &#34;&#34;&#34;
    # leave .resolve() for useful error messages
    rdir = Path(rdir).expanduser().resolve()

    dlist = [x for x in rdir.iterdir() if not baddir(x)]

    if not dlist:
        if not baddir(rdir):
            dlist = [rdir]
        else:
            raise FileNotFoundError(f&#39;no Git repos found under {rdir}&#39;)

    Lmax = len(max(map(attrgetter(&#39;name&#39;), dlist), key=len))
    print(&#39;git&#39;, mode, len(dlist), &#39;paths under&#39;, rdir)

    failed = []
    assert isinstance(GITEXE, str)

    for d in dlist:

        print(f&#39; --&gt; {d.name:&lt;{Lmax}}&#39;, end=&#34;&#34;, flush=True)
        try:
            # don&#39;t use timeout as it doesn&#39;t work right when waiting for user input (password)
            subprocess.check_output([GITEXE] + mode.split(), cwd=d,
                                    universal_newlines=True)
            print(end=&#34;\r&#34;)
        except subprocess.CalledProcessError:
            failed.append(d.name)

        sleep(.1)  # don&#39;t hammer the remote server

    print()
    if failed:
        logging.error(f&#39;git {mode} {rdir}&#39;)
        # no backslash allowed in f-strings
        print(&#39;\n&#39;.join(failed), file=stderr)

    return failed</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="gitutils" href="index.html">gitutils</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="gitutils.pull.fetchpull" href="#gitutils.pull.fetchpull">fetchpull</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.5.3</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>